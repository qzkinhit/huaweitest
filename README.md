初始化清洗器和分析依赖关系...
执行层级和目标模型分类...
执行层级 (并行组): [[{'registered_capital'}, {'annual_turnover'}, {'enterprise_id'}, {'enterprise_address'}, {'social_credit_code'}, {'establishment_date'}], [{'registered_capital_scale'}, {'annual_turnover_interval'}, {'latitude'}, {'longitude'}, {'enterprise_name'}, {'establishment_time'}], [{'province'}, {'industry_first'}, {'enterprise_type'}], [{'city'}, {'industry_second'}], [{'district'}, {'industry_third'}]]
目标模型分类: {'establishment_time': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d3b389c90>], 'registered_capital_scale': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d3b2eba10>], 'industry_third': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2dd05090>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb00d0>], 'industry_second': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2dd9ffd0>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0090>], 'industry_first': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0050>], 'annual_turnover_interval': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0110>], 'province': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0150>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0250>], 'city': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb01d0>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0190>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0350>], 'district': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0210>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0290>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0390>], 'latitude': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb02d0>], 'longitude': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0310>], 'enterprise_type': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb03d0>], 'enterprise_name': [<SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0410>, <SampleScrubber.cleaner.multiple.AttrRelation object at 0x7f9d2ddb0490>]}

处理第 1 层级, 包含节点: ['registered_capital', 'annual_turnover', 'enterprise_id', 'enterprise_address', 'social_credit_code', 'establishment_date']

处理第 2 层级, 包含节点: ['registered_capital_scale', 'annual_turnover_interval', 'latitude', 'longitude', 'enterprise_name', 'establishment_time']
  抽样处理：源属性 ['registered_capital'] -> 目标属性 registered_capital_scale
核心样本抽取时间（秒）: 0.2796592712402344
  在 spark 的分块数: 1
Traceback (most recent call last):
  File "/tmp/spark-7168a27a-cb5b-4934-96b8-bfdd5d004efa/main.py", line 60, in <module>
    rules = CleanBlockonSingle(cleaners, data)
  File "/tmp/spark-7168a27a-cb5b-4934-96b8-bfdd5d004efa/Clean.py", line 47, in CleanBlockonSingle
    sample_df = blockData.toPandas()
  File "/opt/spark/python/lib/pyspark.zip/pyspark/sql/pandas/conversion.py", line 205, in toPandas
  File "/opt/spark/python/lib/pyspark.zip/pyspark/sql/dataframe.py", line 817, in collect
  File "/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1322, in __call__
  File "/opt/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 190, in deco
  File "/opt/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/protocol.py", line 328, in get_return_value
py4j.protocol.Py4JJavaError: An error occurred while calling o423.collectToPython.
: scala.ScalaReflectionException: object org.apache.spark.sql.execution.DliThreadLocalHelper not found.
	at scala.reflect.internal.Mirrors$RootsBase.staticModule(Mirrors.scala:185)
	at scala.reflect.internal.Mirrors$RootsBase.staticModule(Mirrors.scala:29)
	at org.apache.spark.sql.execution.ThreadLocalHelper$.getInstance(ThreadLocalHelper.scala:49)
	at org.apache.spark.sql.execution.SQLExecution$.withThreadLocalCaptured(SQLExecution.scala:204)
	at org.apache.spark.sql.execution.exchange.BroadcastExchangeExec.relationFuture$lzycompute(BroadcastExchangeExec.scala:131)
	at org.apache.spark.sql.execution.exchange.BroadcastExchangeExec.relationFuture(BroadcastExchangeExec.scala:128)
	at org.apache.spark.sql.execution.exchange.BroadcastExchangeExec.doPrepare(BroadcastExchangeExec.scala:199)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:281)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1$adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1$adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1$adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1$adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1$adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$prepare$1$adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare11adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare11adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare11adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare$1(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunprepare11adapted(SparkPlan.scala:277)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)
	at scala.collection.IterableLike.foreach(IterableLike.scala:74)
	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)
	at org.apache.spark.sql.execution.SparkPlan.prepare(SparkPlan.scala:277)
	at org.apache.spark.sql.execution.SparkPlan.anonfunanonfunexecuteQuery$1(SparkPlan.scala:230)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:229)
	at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:190)
	at org.apache.spark.sql.execution.SparkPlan.getByteArrayRdd(SparkPlan.scala:340)
	at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:421)
	at org.apache.spark.sql.Dataset.anonfunanonfuncollectToPython$1(Dataset.scala:3734)
	at org.apache.spark.sql.Dataset.anonfunanonfunwithAction$2(Dataset.scala:3904)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:538)
	at org.apache.spark.sql.Dataset.anonfunanonfunwithAction$1(Dataset.scala:3902)
	at org.apache.spark.sql.execution.SQLExecution..anonfunwithNewExecutionIdwithNewExecutionId6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:187)
	at org.apache.spark.sql.execution.SQLExecution..anonfunwithNewExecutionIdwithNewExecutionId1(SQLExecution.scala:107)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:959)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:69)
	at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3902)
	at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:3731)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.lang.Thread.run(Thread.java:750)

